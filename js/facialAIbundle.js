(()=>{var e={729:()=>{$((function(){"use strict";"ontouchstart"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0||$("html").addClass("cannotTouch"),$.fn.gototop=function(e){var t,o,n=$.extend({startFadeIn:100,container:"body",toTop:"#toTop"},e);function a(e){const t=$(this),o=$("#toTop"),n=t.scrollTop()+t.height(),a=o.offset().top+o.height(),i=t.scrollLeft()+t.width(),c=o.offset().left+o.width();a>=n&&o.offset({top:n-o.height()-20}),c>=i&&o.offset({left:i-o.width()-20})}function i(e){var t,n,a,i;function c(e){if(e.pageX!==t||e.pageY!==n){i=!0;var o=a.left+(e.pageX-t),c=a.top+(e.pageY-n);$(this).offset({top:c,left:o})}}t=e.pageX,n=e.pageY,a=$(this).offset(),i=!1,o=!1,$(this).on("mousemove",c).on("mouseup",(function e(t){$(this).off("mousemove",c).off("mouseup",e),o=i,i=!1}))}function c(e){var t,n,a,i,c;function s(e){var t=e.originalEvent.changedTouches[0];if(e.pageX!==n||e.pageY!==a){c=!0;var o=i.left+(t.pageX-n),s=i.top+(t.pageY-a);$(this).offset({top:s,left:o})}e.preventDefault()}t=e.originalEvent.changedTouches[0],i=$(this).offset(),n=t.pageX,a=t.pageY,c=!1,$(this).on("touchmove",s).on("touchend",(function e(t){var r=t.originalEvent.changedTouches[0],d=i.left+(r.pageX-n),l=i.top+(r.pageY-a);o=c,c=!1,$(this).offset({top:l,left:d}),$(this).off("touchmove",s).off("touchend",e),$(this).click(),t.preventDefault()})),e.preventDefault()}return 0===this.length?($(n.container).prepend('<div id="toTop" title="Go To Top of Page"><i class="fa fa-angle-up fa-3x" aria-hidden="true"></i></div>'),t=$(n.toTop)):t=this,t.each((function(){var e=$(this);function t(){$(window).scrollTop()>n.startFadeIn?e.fadeIn().css("display","inline-block"):e.fadeOut()}function s(){e.css({top:$(window).height()-e.height()-20,left:$(window).width()-e.width()-20})}e.on("mousedown",i).on("touchstart",c),$(window).on("load",t).scroll(t),$(window).on("orientationchange",s),$(window).on("resize",a),s(),e.click((function(e){o||$("body,html").animate({scrollTop:0},800),o=!1,e.stopImmediatePropagation()})),$(window).trigger("scroll")}))},$("#toTop").gototop()}))}},t={};function o(n){if(t[n])return t[n].exports;var a=t[n]={exports:{}};return e[n](a,a.exports,o),a.exports}(()=>{"use strict";o(729);const e=function(){function e(){}return e.prototype.get=function(){return e.validate},e.prototype.set=function(t){e.validate=t},{getInstance:function(){return e.validate||(e.validate=new e,delete e.prototype.constructor),e.validate}}}().getInstance();e.set(!1);const t=e;$((function(){grecaptcha.ready((function(){grecaptcha.execute("6LdWKUMaAAAAAF8zS_5ima4fp7rtuDz19s2tdvEU",{action:"facialai"}).then((function(e){$("#recaptchaResponse").val(e)}))})),$("#recaptchacheck").submit((function(e){if(e.preventDefault(),t.get())return!1;$.ajax({url:"verifyperson.php",type:"POST",data:$(this).serialize(),dataType:"json"}).done((function(e){const{status:o,message:n}=e;o?(t.set(!0),$("#alert").addClass("d-none").text("")):$("#alert").removeClass("d-none").text(n)})).fail((function(e,t,o){$("#alert").removeClass("d-none").text(e.responseText)}))}))})),"localhost"!==location.hostname&&"127.0.0.1"!==location.hostname&&"https:"!==location.protocol&&location.replace(`https:${location.href.substring(location.protocol.length)}`);const n=document.querySelector(".start"),a=document.querySelector(".stop"),i=document.querySelector(".restart"),c=document.querySelector(".video"),s=document.querySelector(".loading"),r=document.querySelector(".instructions"),d=document.querySelector("#gender"),l=document.querySelector("#genderProbability"),u=document.querySelector("#age"),p=document.querySelector("#expression"),f=document.querySelector("#expressionProbability");let h=!1;i.addEventListener("click",(()=>window.location.reload())),Promise.all([faceapi.nets.tinyFaceDetector.loadFromUri("./models"),faceapi.nets.faceRecognitionNet.loadFromUri("./models"),faceapi.nets.faceExpressionNet.loadFromUri("./models"),faceapi.nets.ageGenderNet.loadFromUri("./models")]).then((()=>navigator.mediaDevices.getUserMedia({video:{facingMode:"user"},audio:!1}))).then((e=>{c.srcObject=e})).catch((e=>{s.innerText=`Error!  ${e}`})),c.addEventListener("playing",(()=>{const e=[];s.classList.remove("active"),n.addEventListener("click",(t=>{h=!0,o.classList.add("active"),r.classList.add("active"),e.length=0;const n=document.querySelector(".captureCanvas");n.width=c.videoWidth,n.height=c.videoHeight,n.getContext("2d").drawImage(c,0,0,c.videoWidth,c.videoHeight),n.toBlob((e=>async function(e){const t=new FormData;t.append("system","FacialAI"),t.append("capturedImage",e,"FacialAIBlob");const o=await fetch("./upload/",{method:"POST",body:t});await o.json()}(e)))})),a.addEventListener("click",(e=>{h=!1,o.classList.remove("active")}));const o=faceapi.createCanvasFromMedia(c);o.classList.add("canvas"),c.parentNode.insertBefore(o,c.nextSibling);const i={width:+window.getComputedStyle(c).width.slice(0,-2),height:+window.getComputedStyle(c).height.slice(0,-2)};faceapi.matchDimensions(o,i),setInterval((async()=>{const n=await faceapi.detectAllFaces(c,new faceapi.TinyFaceDetectorOptions).withFaceExpressions().withAgeAndGender(),a=faceapi.resizeResults(n,i);if(o.getContext("2d").clearRect(0,0,o.width,o.height),t.get()&&h&&a.length>0){const{gender:t,genderProbability:o,age:n,expressions:i}=a[0],c=function(t){return e.unshift(t)>=31&&(e.length=30),e.reduce(((e,t)=>e+t))/e.length}(n),s=Object.keys(i),r=s.sort(((e,t)=>i[e]-i[t]))[s.length-1];d.innerText=t.toUpperCase(),l.innerText=`${Math.round(100*o)}%`,u.innerText=`${Math.round(c,1)} years old`,p.innerText=r.toUpperCase(),f.innerText=`${Math.round(100*i[r])}%`}}),100)}))})()})();